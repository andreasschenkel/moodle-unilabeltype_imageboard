{"version":3,"file":"imageboarddraganddrop.min.js","sources":["../src/imageboarddraganddrop.js"],"sourcesContent":["/**\n * Unilabel type imageboard\n *\n * @author      Andreas Schenkel\n * @copyright   Andreas Schenkel {@link https://github.com/andreasschenkel}\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const init = () => {\n    // Store some data about the selected image that is moved.\n    var activeItem = null;\n    var activeNumber = null;\n    // itemToMove is the div that the selected image is inside. We do NOT move the image we move the div.\n    var itemToMove = null;\n    var xoffset = 0;\n    var yoffset = 0;\n    var canvas = null;\n    listener();\n\n    /**\n     *\n     */\n    function listener() {\n        ////console.log(\"listener\");\n        setTimeout(function() {\n            canvas = document.getElementById(\"unilabel-imageboard-background-area\");\n            canvas.addEventListener(\"mousedown\", dragStart, false);\n            canvas.addEventListener(\"mousemove\", drag, false);\n            canvas.addEventListener(\"mouseup\", dragEnd, false);\n        }, 1000);\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function dragStart(event) {\n        console.log(\"dragStart\");\n        console.log(\"event\", event);\n        if (event.target.classList.contains('image')) {\n            event.preventDefault();\n            activeItem = event.target;\n            activeNumber = event.target.getAttribute('id').split('unilabel-imageboard-imageid_')[1];\n            itemToMove = document.getElementById('unilabel_imageboard_imagediv_' + activeNumber);\n            var position = canvas.getBoundingClientRect();\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            xoffset = event.layerX;\n            yoffset = event.layerY;\n            console.log(\"event.clientX - offsetLeft - xoffset\", event.clientX, offsetLeft, xoffset);\n            console.log(\"event.clientY - offsetTop - yoffset\", event.clientY, offsetTop, yoffset);\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (activeItem) {\n                itemToMove.style.left = Math.round(xposition) + \"px\";\n                itemToMove.style.top = Math.round(yposition) + \"px\";\n            }\n        } else {\n            ///console.log(\"no image selected\");\n        }\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function drag(event) {\n        //event.preventDefault();\n        console.log(\"drag\");\n        console.log(\"event\", event);\n        if (event.target.classList.contains('image') && activeItem) {\n            var position = canvas.getBoundingClientRect();\n            console.log(\"position\", position);\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            //var xoffset = event.target.clientWidth / 2;\n            //var yoffset = event.target.clientHeight / 2;\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (xposition < 0) {\n                xposition = 0;\n            }\n            if (yposition < 0) {\n                yposition = 0;\n            }\n            itemToMove.style.left = Math.round(xposition) + \"px\";\n            itemToMove.style.top = Math.round(yposition) + \"px\";\n            // Change the inputfield\n            const input_xposition = document.getElementById('id_unilabeltype_imageboard_xposition_' + (activeNumber));\n            const input_yposition = document.getElementById('id_unilabeltype_imageboard_yposition_' + (activeNumber));\n            input_xposition.value = Math.round(xposition);\n            input_yposition.value = Math.round(yposition);\n        }\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function dragEnd(event) {\n        //event.preventDefault();\n        console.log(\"----dragEnd\");\n        console.log(\"event\", event);\n        if (activeItem) {\n            var position = canvas.getBoundingClientRect();\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            //var xoffset = event.target.clientWidth / 2;\n            //var yoffset = event.target.clientHeight / 2;\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (xposition < 0) {\n                xposition = 0;\n            }\n            if (yposition < 0) {\n                yposition = 0;\n            }\n            itemToMove.style.left = Math.round(xposition) + \"px\";\n            itemToMove.style.top = Math.round(yposition) + \"px\";\n\n            // Change the inputfield\n            const input_xposition = document.getElementById('id_unilabeltype_imageboard_xposition_' + (activeNumber));\n            const input_yposition = document.getElementById('id_unilabeltype_imageboard_yposition_' + (activeNumber));\n            input_xposition.value = Math.round(xposition);\n            input_yposition.value = Math.round(yposition);\n            activeItem = null;\n            activeNumber = null;\n        }\n    }\n};\n\n"],"names":["activeItem","activeNumber","itemToMove","xoffset","yoffset","canvas","dragStart","event","console","log","target","classList","contains","preventDefault","getAttribute","split","document","getElementById","position","getBoundingClientRect","offsetLeft","left","offsetTop","top","layerX","layerY","clientX","clientY","xposition","yposition","style","Math","round","drag","input_xposition","input_yposition","value","dragEnd","setTimeout","addEventListener"],"mappings":"kLAQoB,SAEZA,WAAa,KACbC,aAAe,KAEfC,WAAa,KACbC,QAAU,EACVC,QAAU,EACVC,OAAS,cAoBJC,UAAUC,UACfC,QAAQC,IAAI,aACZD,QAAQC,IAAI,QAASF,OACjBA,MAAMG,OAAOC,UAAUC,SAAS,SAAU,CAC1CL,MAAMM,iBACNb,WAAaO,MAAMG,OACnBT,aAAeM,MAAMG,OAAOI,aAAa,MAAMC,MAAM,gCAAgC,GACrFb,WAAac,SAASC,eAAe,gCAAkChB,kBACnEiB,SAAWb,OAAOc,wBAClBC,WAAaF,SAASG,KACtBC,UAAYJ,SAASK,IACzBpB,QAAUI,MAAMiB,OAChBpB,QAAUG,MAAMkB,OAChBjB,QAAQC,IAAI,uCAAwCF,MAAMmB,QAASN,WAAYjB,SAC/EK,QAAQC,IAAI,sCAAuCF,MAAMoB,QAASL,UAAWlB,aACzEwB,UAAYrB,MAAMmB,QAAUN,WAAajB,QACzC0B,UAAYtB,MAAMoB,QAAUL,UAAYlB,QACxCJ,aACAE,WAAW4B,MAAMT,KAAOU,KAAKC,MAAMJ,WAAa,KAChD1B,WAAW4B,MAAMP,IAAMQ,KAAKC,MAAMH,WAAa,gBAWlDI,KAAK1B,UAEVC,QAAQC,IAAI,QACZD,QAAQC,IAAI,QAASF,OACjBA,MAAMG,OAAOC,UAAUC,SAAS,UAAYZ,WAAY,KACpDkB,SAAWb,OAAOc,wBACtBX,QAAQC,IAAI,WAAYS,cACpBE,WAAaF,SAASG,KACtBC,UAAYJ,SAASK,IAGrBK,UAAYrB,MAAMmB,QAAUN,WAAajB,QACzC0B,UAAYtB,MAAMoB,QAAUL,UAAYlB,QACxCwB,UAAY,IACZA,UAAY,GAEZC,UAAY,IACZA,UAAY,GAEhB3B,WAAW4B,MAAMT,KAAOU,KAAKC,MAAMJ,WAAa,KAChD1B,WAAW4B,MAAMP,IAAMQ,KAAKC,MAAMH,WAAa,WAEzCK,gBAAkBlB,SAASC,eAAe,wCAA2ChB,cACrFkC,gBAAkBnB,SAASC,eAAe,wCAA2ChB,cAC3FiC,gBAAgBE,MAAQL,KAAKC,MAAMJ,WACnCO,gBAAgBC,MAAQL,KAAKC,MAAMH,qBAQlCQ,QAAQ9B,UAEbC,QAAQC,IAAI,eACZD,QAAQC,IAAI,QAASF,OACjBP,WAAY,KACRkB,SAAWb,OAAOc,wBAClBC,WAAaF,SAASG,KACtBC,UAAYJ,SAASK,IAGrBK,UAAYrB,MAAMmB,QAAUN,WAAajB,QACzC0B,UAAYtB,MAAMoB,QAAUL,UAAYlB,QACxCwB,UAAY,IACZA,UAAY,GAEZC,UAAY,IACZA,UAAY,GAEhB3B,WAAW4B,MAAMT,KAAOU,KAAKC,MAAMJ,WAAa,KAChD1B,WAAW4B,MAAMP,IAAMQ,KAAKC,MAAMH,WAAa,WAGzCK,gBAAkBlB,SAASC,eAAe,wCAA2ChB,cACrFkC,gBAAkBnB,SAASC,eAAe,wCAA2ChB,cAC3FiC,gBAAgBE,MAAQL,KAAKC,MAAMJ,WACnCO,gBAAgBC,MAAQL,KAAKC,MAAMH,WACnC7B,WAAa,KACbC,aAAe,MAtGnBqC,YAAW,YACPjC,OAASW,SAASC,eAAe,wCAC1BsB,iBAAiB,YAAajC,WAAW,GAChDD,OAAOkC,iBAAiB,YAAaN,MAAM,GAC3C5B,OAAOkC,iBAAiB,UAAWF,SAAS,KAC7C"}