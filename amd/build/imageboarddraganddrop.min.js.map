{"version":3,"file":"imageboarddraganddrop.min.js","sources":["../src/imageboarddraganddrop.js"],"sourcesContent":["/**\n * Unilabel type imageboard\n *\n * @author      Andreas Schenkel\n * @copyright   Andreas Schenkel {@link https://github.com/andreasschenkel}\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const init = () => {\n    // Store some data about the selected image that is moved.\n    var activeItem = null;\n    var activeNumber = null;\n    // itemToMove is the div that the selected image is inside. We do NOT move the image we move the div.\n    var itemToMove = null;\n    var xoffset = 0;\n    var yoffset = 0;\n    var canvas = null;\n    var activewidth = null;\n    var activeheight = null;\n\n    var canvaswidth = 950;\n    var canvasheight = 400;\n\n\n    listener();\n\n    /**\n     *\n     */\n    function listener() {\n        ////console.log(\"listener\");\n        setTimeout(function() {\n            canvas = document.getElementById(\"unilabel-imageboard-background-area\");\n            canvas.addEventListener(\"mousedown\", dragStart, false);\n            canvas.addEventListener(\"mousemove\", drag, false);\n            canvas.addEventListener(\"mouseup\", dragEnd, false);\n        }, 1000);\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function dragStart(event) {\n        console.log(\"dragStart\");\n        console.log(\"event\", event);\n        if (event.target.classList.contains('image')) {\n            event.preventDefault();\n            activeItem = event.target;\n            activeNumber = event.target.getAttribute('id').split('unilabel-imageboard-imageid_')[1];\n            activewidth = event.target.style.width.split('px')[0];\n            // ToDo: height auto needs different code\n            activewidth = event.target.style.width.split('px')[0];\n            activeheight = event.target.style.height.split('px')[0];\n            itemToMove = document.getElementById('unilabel_imageboard_imagediv_' + activeNumber);\n            var position = canvas.getBoundingClientRect();\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            xoffset = event.layerX;\n            yoffset = event.layerY;\n            console.log(\"event.clientX - offsetLeft - xoffset\", event.clientX, offsetLeft, xoffset);\n            console.log(\"event.clientY - offsetTop - yoffset\", event.clientY, offsetTop, yoffset);\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (activeItem) {\n                itemToMove.style.left = Math.round(xposition) + \"px\";\n                itemToMove.style.top = Math.round(yposition) + \"px\";\n            }\n        } else {\n            ///console.log(\"no image selected\");\n        }\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function drag(event) {\n        //event.preventDefault();;\n        console.log(\"event\", event);\n        if (event.target.classList.contains('image') && activeItem) {\n            var position = canvas.getBoundingClientRect();\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (xposition < 0) {\n                xposition = 0;\n            }\n            if (yposition < 0) {\n                yposition = 0;\n            }\n\n            if (xposition >= canvaswidth - activewidth) {\n                xposition = canvaswidth - activewidth;\n            }\n            if (yposition >= canvasheight - activeheight) {\n                yposition = canvasheight - activeheight;\n            }\n            itemToMove.style.left = Math.round(xposition) + \"px\";\n            itemToMove.style.top = Math.round(yposition) + \"px\";\n            // Change the inputfield\n            const inputPositionX = document.getElementById('id_unilabeltype_imageboard_xposition_' + (activeNumber));\n            const inputPositionY = document.getElementById('id_unilabeltype_imageboard_yposition_' + (activeNumber));\n            inputPositionX.value = Math.round(xposition);\n            inputPositionY.value = Math.round(yposition);\n        }\n    }\n\n    /**\n     *\n     * @param {event} event\n     */\n    function dragEnd(event) {\n        //event.preventDefault();\n        console.log(\"----dragEnd\");\n        console.log(\"event\", event);\n        if (activeItem) {\n            var position = canvas.getBoundingClientRect();\n            var offsetLeft = position.left;\n            var offsetTop = position.top;\n            var xposition = event.clientX - offsetLeft - xoffset;\n            var yposition = event.clientY - offsetTop - yoffset;\n            if (xposition < 0) {\n                xposition = 0;\n            }\n            if (yposition < 0) {\n                yposition = 0;\n            }\n            if (xposition >= canvaswidth - activewidth) {\n                xposition = canvaswidth - activewidth;\n            }\n            if (yposition >= canvasheight - activeheight) {\n                yposition = canvasheight - activeheight;\n            }\n            itemToMove.style.left = Math.round(xposition) + \"px\";\n            itemToMove.style.top = Math.round(yposition) + \"px\";\n\n            // Change the inputfield\n            const inputPositionX = document.getElementById('id_unilabeltype_imageboard_xposition_' + (activeNumber));\n            const inputPositionY = document.getElementById('id_unilabeltype_imageboard_yposition_' + (activeNumber));\n            inputPositionX.value = Math.round(xposition);\n            inputPositionY.value = Math.round(yposition);\n            activeItem = null;\n            activeNumber = null;\n        }\n    }\n};\n"],"names":["activeItem","activeNumber","itemToMove","xoffset","yoffset","canvas","activewidth","activeheight","dragStart","event","console","log","target","classList","contains","preventDefault","getAttribute","split","style","width","height","document","getElementById","position","getBoundingClientRect","offsetLeft","left","offsetTop","top","layerX","layerY","clientX","clientY","xposition","yposition","Math","round","drag","inputPositionX","inputPositionY","value","dragEnd","setTimeout","addEventListener"],"mappings":"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"}